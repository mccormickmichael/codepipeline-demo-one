# codepipeline-demo-one

Demonstrate CodeBuild, CodeDeploy, CodePipeline

Prerequisites:

- Fork this repo
- Run the `/cf/demo_bucket.yml` stack definition to create an S3 bucket to hold build artifacts

CodeBuild

1.  Run the `/cf/code_build.yml` stack definition to creae a CodeBuild project
2.  Run the build.
3.  Change something in `/app`, push and run again

CodeDeploy

1.  Run the `/cf/app_infra.yml` stack definition to create a simple web server.
    The server's host name is in the stack outputs.
2.  Run the `/cf/code_deploy.yml` stack definition to create CodeDeploy project.
    You'll need the name of your web server stack.
3.  Deploy a new revision of your app using the zip file generated by CodeBuild
4.  Hit the web server to see that it worked!

CodePipeline

0.  Create an SNS topic and subscribe to it
0.  Create a GitHub API Token. Give it `repo` and `admin:repo` permissions
1.  Run the `/cf/app_infra.yml` stack definition to create a simple test web server.
2.  Run the `/cf/app_infra.yml` stack definition again to create a simple PROD web server.
3.  Run the `/cf/code_pipeline.yml` stack definition to create the pipeline.
    You'll need the GitHub token, your SNS topic, and the names of your Test and Prod stacks.
4.  Run the pipeline. You should get a notification when the Prod deployment is ready
5.  Hit your test web server to see that it works.
6.  Approve to ship to Prod!
7.  Hit your prod web server to see that you are in Prod!
8.  Change something in `/app`, push and watch your change move through the pipeline!